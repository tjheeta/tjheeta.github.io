
<!DOCTYPE html>
<html lang="en-us">

    <head>

        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />

        <meta property="og:title" content=" Dawn of the Microlith - Monoservices with Elixir &middot;  Nothing interesting..." />
        <meta property="og:site_name" content="Nothing interesting..." />
        <meta property="og:url" content="http://tjheeta.github.io/2016/12/16/dawn-of-the-microlith-monoservices-microservices-with-elixir/" />

    
        <meta property="og:type" content="article" />
        <meta property="og:article:published_time" content="2016-12-16T05:52:00Z" />
        <meta property="og:article:tag" content="elixir" />
        <meta property="og:article:tag" content="microservices" />
        <meta property="og:article:tag" content="devops" />
        

        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@" />
        <meta name="twitter:creator" content="@" />
        <meta name="twitter:title" content="Dawn of the Microlith - Monoservices with Elixir" />
        <meta name="twitter:description" content="" />
        <meta name="twitter:url" content="http://tjheeta.github.io/2016/12/16/dawn-of-the-microlith-monoservices-microservices-with-elixir/" />
    

        <title> Dawn of the Microlith - Monoservices with Elixir &middot;  Nothing interesting...</title>

    
        <meta name="description" content="" />
    
        
        <meta name="p:domain_verify" content="fc173d84e3a4de948ed4bda2908afd3e"/>
        <meta name="HandheldFriendly" content="True" />
        <meta name="MobileOptimized" content="320" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        
          

    
        <link href="http://tjheeta.github.io/index.xml" rel="alternate" type="application/rss+xml" title="Nothing interesting..." />
    

    
        <link rel="canonical" href="http://tjheeta.github.io/2016/12/16/dawn-of-the-microlith-monoservices-microservices-with-elixir/" />

    
    <script type="application/ld+json">
    { 
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "Dawn of the Microlith - Monoservices with Elixir",
        "author": {
            "@type": "Person",
            "name": "http://profiles.google.com/?rel=author"
        },
        "datePublished": "2016-12-16",
        "description": "",
        "wordCount": 4171
    }
    </script>
    
    
    <style>
*{padding:0;margin:0}body,html{font-size:1em;line-height:1.65em;font-family:"Open Sans",sans-serif;font-weight:300;color:#444}html{height:100%}body{padding:2em 2.5em 1em 20em}table, th, td { border: 1px solid black; border-collapse: collapse; padding: 10px;}header{border-right:1px #eee solid;padding:2em;position:fixed;top:0;left:0;height:100%;width:13.5em}#content{display:block;width:100%}footer{padding:1em 0 2.5em;font-size:.8em;line-height:1.5em;color:#888}article{border-bottom:.1em #eee solid;padding-bottom:1.7em;max-width:56em}h4,h5,h6,hr,p{margin-top:.9em;margin-bottom:.9em}h1,h2,h3,h4,h5,h6{font-family:"Bree Serif",serif;font-weight:400!important}h1{font-size:2.5em;line-height:1.1em;margin-top:.6em;margin-bottom:.6em}h2{font-size:1.9em;line-height:1.2em;margin-top:.7em;margin-bottom:.7em}h3{font-size:1.4em;line-height:1.3em;margin-top:.8em;margin-bottom:.8em}h4{font-size:1.3em}h5{font-size:1.2em}h6{font-size:1.1em}iframe,img{max-width:100%}a{font-weight:700;text-decoration:none;color:#5cc265}a:hover{text-decoration:underline}h1 a,h2 a,h3 a,h4 a,h5 a,h6 a{font-weight:400!important}strong{font-weight:700}blockquote{border-left:.4em solid #eee;padding-left:1.2em;font-size:1.3em}hr{border:0;height:1px;background:#eee}ol,ul{margin-left:3em}code{font-size:1.4em;background:#eee}pre{font-size:.8em;line-height:2em;background:#eee;padding:1em;word-break:break-all;word-wrap:break-word;white-space:pre;white-space:-moz-pre-wrap;white-space:pre-wrap}input{font-size:1em;padding:.3em}header h1{font-size:1.9em;margin-top:.8em;margin-bottom:.6em}header h1 a{color:#444}header h1 a:hover{text-decoration:none}header #logo img{width:9em;height:9em;border-radius:4.5em;-moz-border-radius:4.5em;-webkit-border-radius:4.5em;border:none}#follow-icons{font-size:.7em;margin-top:-.7em;margin-bottom:1.5em}#follow-icons a{color:#ccc}#follow-icons span{vertical-align:top;margin-left:-.15em;margin-right:-.15em}#follow-icons span .fa-stack-1x{font-size:1.05em;line-height:1.9em}header h6{margin-top:.5em}article span.post-stamp{color:#888}h1.post-title{margin-top:.35em;margin-bottom:.6em}h3.post-title{margin-top:.4em;padding-bottom:.9em;border-bottom:1px solid #eee;font-size:1.2em;color:#444}.post-title .feature-star{font-size:.9em}.feature-star,.separator,.taglist{color:#ccc}.taglist a{background-color:#ccc;color:#fff;display:inline-block;line-height:1.5em;padding:.3em .6em;vertical-align:20%;font-size:.5em;font-family:"Open Sans",sans-serif;font-weight:700!important;text-transform:uppercase;letter-spacing:.05em;border-radius:.25em;-moz-border-radius:.25em;-webkit-border-radius:.25em}#social-bar{margin-top:1.5em;background-color:#eee;padding:.5em}#comments{margin-top:.15em;padding-bottom:.2em;border-bottom:1px solid #eee}.pagination{margin-bottom:1em}footer a{font-weight:300;color:#888;text-decoration:underline}footer a:hover{color:#444;text-decoration:none}@media only screen and (min-width:1281px){body,html{font-size:1.1em}}@media only screen and (max-width:800px){body{padding:0}header{border-right:none;border-bottom:1px #eee solid;position:relative;height:auto;width:auto;text-align:center;padding-bottom:1em}#content{margin-left:0;padding:2em 2em 1em;width:auto}footer{padding:0 2.5em 2em}}@media only screen and (max-width:320px){#content,header{padding:1.2em 1.2em .6em}footer{padding:0 1.5em 1.2em}ol,ul{margin-left:2em}}
</style>

    </head>
    <body>
        <header id="header">
            <a id="logo" href="http://tjheeta.github.io/"><img src="/images/logo.png" alt="Nothing interesting..." /></a>
            <h1><a href="http://tjheeta.github.io/">Nothing interesting...</a></h1>
            <p></p>

            <div id="follow-icons">
    <a href="https://github.com/tjheeta" rel="me"><i class="fa fa-github-square fa-2x"></i></a>
    <a href="http://tjheeta.github.io/index.xml" rel="me"><i class="fa fa-rss-square fa-2x"></i></a>.
</div>

            <h6><a href="/about/">About</a></h6>
<style>
#logo {

    }


:link { color: #FF0000; }
:visited { color: #8B0000; }
</style>

        </header>

<script type="text/x-mathjax-config">
 MathJax.Hub.Config({
     displayAlign: "center",
     displayIndent: "0em",

     "HTML-CSS": { scale: 100,
                   linebreaks: { automatic: "false" },
                   webFont: "TeX"
     },
     SVG: {scale: 100,
           linebreaks: { automatic: "false" },
           font: "TeX"},
     NativeMML: {scale: 100},
     TeX: { equationNumbers: {autoNumber: "AMS"},
            MultLineWidth: "85%",
            TagSide: "right",
            TagIndent: ".8em"
     }
 });
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>


<main id="content">

<article id="" class="post">
    <div class="post-stamp">
        <time datetime="2016-12-16T05:52:00Z">
            16 Dec 2016
        </time>
        <span class="taglist">
        
        &middot;
        
            <a href="http://tjheeta.github.io/tags/elixir/">elixir</a>
        
            <a href="http://tjheeta.github.io/tags/microservices/">microservices</a>
        
            <a href="http://tjheeta.github.io/tags/devops/">devops</a>
        
        
        </span>
    </div>
    <h1 class="post-title">Dawn of the Microlith - Monoservices with Elixir</h1>
    <div id="toc" class="well col-md-4 col-sm-6">
       <nav id="TableOfContents">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#business-value-getting-to-and-operating-in-production">Business value - getting to and operating in production</a>
<ul>
<li><a href="#costs-with-a-monolith">Costs with a monolith</a></li>
<li><a href="#costs-with-microservices">Costs with microservices</a>
<ul>
<li><a href="#microservice-anti-patterns">Microservice anti-patterns</a></li>
<li><a href="#operations-costs">Operations Costs</a></li>
<li><a href="#communication-fabric">Communication fabric</a></li>
<li><a href="#eventual-consistency-patterns">Eventual consistency patterns</a></li>
<li><a href="#versioning">Versioning</a></li>
<li><a href="#qa-costs">QA Costs</a></li>
<li><a href="#deployment">Deployment</a></li>
<li><a href="#security">Security</a></li>
</ul></li>
<li><a href="#costs-with-a-microlith-monoservices-elixir-the-middle-ground">Costs with a microlith/monoservices - Elixir - the middle ground</a>
<ul>
<li><a href="#so-what-is-elixir">So what is Elixir?</a>
<ul>
<li><a href="#technical-aside-robustness-principles-microservices-paas-vs-erlang-elixir">Technical aside - robustness principles - Microservices+PAAS vs Erlang/Elixir</a>
<ul>
<li><a href="#table-comparison-of-basic-principles-paas-vs-erlang">Table - comparison of basic principles PAAS vs Erlang</a></li>
</ul></li>
<li><a href="#technical-aside-let-it-crash-an-example-of-these-principles">Technical aside - Let it crash - an example of these principles</a></li>
</ul></li>
<li><a href="#comparison-with-microservices">Comparison with microservices</a>
<ul>
<li><a href="#table-comparison-of-costs-for-a-monolith-for-microservices-and-elixir">Table - comparison of costs for a monolith for microservices and elixir</a></li>
</ul></li>
<li><a href="#alternatives">Alternatives</a></li>
</ul></li>
</ul></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
</nav>
    </div>
    

<h1 id="introduction">Introduction</h1>

<p>Microservices are the newest technology trend and should be approached with deliberation. There is a ludicrous amount of subject matter on it, which I&rsquo;m not going to cover. The important part to understand is if they are a fit for your organization.</p>

<p>To measure if the architecture adds business value, it really comes down to how quickly can features be released to production and the stability / maintainability of the codebase. Whether microservices work or not also depend on the organizational structure and maturity. Building different components with independent deployment and loose coupling is definitely one way to do that and gives a sense of ownership to teams that can help kickstart innovation and creativity. The tradeoff of independence and potential innovation is that it is pushing the complexity of building and quickly iterating on a large code base into the QA and operations.</p>

<p>However, there are alternatives which give the advantages of both monoliths and microservices.</p>

<h1 id="business-value-getting-to-and-operating-in-production">Business value - getting to and operating in production</h1>

<p>Classifying the costs in an engineering organization into two major categories:</p>

<ol>
<li><strong>Build</strong>. Cost of iteration/creation of a new feature/product. Over long periods of time, it may become difficult to know if one change will affect something else in the system causing development to slow down.</li>
<li><strong>Operate</strong>. The maintenance cost of these feature/product sets in production. Debugging large systems is difficult as there are many interlocking calls through classes or services. Reliability of a service in production is paramount.</li>
</ol>

<p>Complexity of large projects are here to stay and microservices add additional devops, qa, and operational cost. If an organization has built a unmaintainable monolith, what would change when moving to microservices? That being said - they can certainly help in decomposition given the right discipline.</p>

<p>Microservices are like a gym membership. Just because someone has a gym membership, doesn&rsquo;t mean that suddenly they will have the discipline to get in shape. Similarly, just because there&rsquo;s an expensive network boundary to enforce modularization and a clean interface, doesn&rsquo;t mean the code will magically be written. Essentially, classes in a language are very cheap to create and require no discipline, but microservices may make someone think twice because of the network boundary. This may help, but, then again, this strategy might be the same success rate of a New Year&rsquo;s resolution.</p>

<p>In smaller projects, I&rsquo;m not sure why anyone would use with microservices other than perhaps conversion of performance hotspots.</p>

<h2 id="costs-with-a-monolith">Costs with a monolith</h2>

<p>Now there are some natural problems in a large monolithic codebases:</p>

<ol>
<li>too many developers trying to make changes causes long merge windows</li>
<li>build and test may take too long to run</li>
<li>more costly to scale as hotspots may be small compared to full application size</li>
<li>longer startup and initialization times</li>
</ol>

<p>There&rsquo;s a clear roadmap of engineering practices to get to continuous deployment. It may not be easy to get to the end of the road, but it is well-defined. Note that the QA and operations of the system has moved from a model of mean time between failure to mean-time to recovery. The engineering changes could involve:</p>

<ol>
<li>Automated testing</li>
<li>Metrics and fault detection</li>
<li>Blue/green and canary deployments (potentially)</li>
<li>Trunk-based development (potentially)</li>
<li>Feature toggles (potentially)</li>
</ol>

<p>However, even if continuous deployment is achieved, it could still be difficult to have ownership and innovation. There could also remain problems with scaling, size, and organizational structure.</p>

<h2 id="costs-with-microservices">Costs with microservices</h2>

<p>Interestingly enough, the smaller codebases are easier to maintain, but the complexity has now moved to the interactions between all the different components. Nothing goes away from our monolithic requirements though as we still want continuous delivery on all our services.</p>

<p>But now there&rsquo;s definitely some extra cost.  It&rsquo;s a lot of work. This list is from both experience and endless conversations. There are many pre-requisites which we&rsquo;ll go over below.</p>

<h3 id="microservice-anti-patterns">Microservice anti-patterns</h3>

<p>There are thousand ways to die in the wild west. For instance, without well-defined service boundaries in moving from monolith to microservice, you could end up building a distributed monolith. There are the additional network costs and flakiness to account for. Because of this, I&rsquo;m limiting anti-patterns to that which will either cause difficulty for services in deploying independently or large extra cost in maintaining in production.</p>

<ul>
<li>Tight coupling - Services need to be able to deploy independently. Tight coupling could be caused through shared libraries forcing an upgrade throughout the system. Or they could be coupled through a database schema where many services need to upgrade based on a schema change.</li>
<li>Too fine grained - this will just drive up latency. These aren&rsquo;t classes and could cause production problems.</li>
<li>JSON over REST - if it leads to cascading synchronous chained blocking calls. There are libraries such as <a href="https://github.com/Netflix/Hystrix">Hystrix</a> and <a href="http://www.grpc.io/">GRPC</a> to help with this. Also, JSON requires serialization/deserialization which could cause problems for chatty services.</li>
<li>Distributed objects - if you&rsquo;re constructing objects over the network, you&rsquo;re going to have a bad time.</li>
<li>Canonical data model - good luck with that.</li>
</ul>

<h3 id="operations-costs">Operations Costs</h3>

<p>Before we can even start with microservices, we need to have a platform to run them. It&rsquo;s a good chance that the platform will be <a href="http://kubernetes.io/">Kubernetes</a> - an open-source container management system from Google. They&rsquo;ve made some excellent trade-offs in moving the complexity to the routing and discovery and keeping the deployment and namespacing clean. There is <a href="https://github.com/kubernetes/helm">Helm</a> which provides a great way to deploy systems easily on a cluster. Of course, there also needs to be a container runtime which will probably end up being <a href="http://docker.io">Docker</a>. I&rsquo;m not a big fan, but it does the job.</p>

<p>There is a material cost in operating a cluster. Without going through a definitive list, the most recent bugs that I&rsquo;ve witnessed are:</p>

<ul>
<li>Kubernetes is <a href="https://github.com/kubernetes/kubernetes/issues/26670">limited</a> to 50 or 250 services per cluster on AWS depending on the setup.</li>
<li>Docker doesn&rsquo;t currently delete containers and requires a reboot to be able to create again. Has to do with migration to systemd and not checking available ip addresses.</li>
</ul>

<p>What can I say, there&rsquo;s work, but it&rsquo;s still easier to maintain than Openstack. Of course, Google Cloud provides Kubernetes clusters, which could certainly simplify matters for your organization. There are a plethora of other choices: <a href="http://vamp.io/">vamp</a>, <a href="http://docker.io">docker</a>, <a href="http://gilliam.github.io/">gilliam</a>, <a href="http://rancher.com">rancher</a>, <a href="http://deis.io/">deis</a>, <a href="https://pivotal.io/platform">pivotal</a>, etc, etc.</p>

<p>However, there is still a matter of debugging in production and for that we would need to be able to trace requests. The easy way would be to add a correlation id to a header on every request and use centralized logging to trace. But if you want more details, then <a href="http://zipkin.io/">zipkin</a> or the newer <a href="http://opentracing.io/">opentracing</a> come to the fore.</p>

<h3 id="communication-fabric">Communication fabric</h3>

<p>Services need to communicate with each other. Networks fail often, and there needs to be a strategy for fault-tolerance. How will communication happen? Is it going to be JSON over REST? <a href="https://github.com/Netflix/Hystrix">Hystrix</a>? <a href="http://www.grpc.io/">GRPC</a>? <a href="https://linkerd.io/">Linkerd</a>? I haven&rsquo;t kept up with the PAAS layers for the past months, but if you&rsquo;re not using Kubernetes, you may also need to consider service discovery and routing. The communication layer could also account for stopping cascading failure via circuit breakers, latency, etc. Also, there could be a message bus involved, and if so, it should probably remain as dumb as possible, lest it turn into an enterprise service bus (ESB).</p>

<h3 id="eventual-consistency-patterns">Eventual consistency patterns</h3>

<p>So let&rsquo;s say we drew up all the service boundaries, and service A has data service B needs. What then? If service B has direct access to service A&rsquo;s database, then those are tightly coupled and should probably be one service. If service B keeps a copy of service A&rsquo;s data, then we have an eventual consistency problem. If service B queries service A every request, then this could be a hard dependency with cascading failure.</p>

<p>Assuming in a microservices architecture that we want service B to keep a copy of the data, this becomes an eventual consistency problem. I know of three major ways to deal with who owns resolving the consistency:</p>

<ul>
<li>First party responsibility - distributed transactions. Service A writes the data to its datastore, followed by ensuring that the writes occur on all other systems that desire the data.</li>
<li>Third party responsibility - event sourcing. Service A sends the event across a bus, all services that require the data subscribe to the event. For reconciliation, this may also require a 3rd party listener that records all of the events. If someone misses an event, this 3rd party owns the data and can replay them. This also could lead us to CQRS and materialized views. Note that sending data over a bus could also be problematic due to delivery and ordering issues. A message could be delivered multiple times or arrive out of order. Would need to implement CRDT&rsquo;s or some other resolution mechanism on all the consumers.</li>
<li>Second party responsibility - the owner of the data keeps a transaction log. The owner of the data could send an event across a bus if necessary, but the responsibilty belongs to the consumer. Let&rsquo;s say that the consumer decides to implement polling of the source system. If there are 100 events, but only 5 id&rsquo;s changed during the time (each having 20 changes), on poll the source would list those 5 id&rsquo;s. Then the consumer could fetch the id&rsquo;s at their convenience. This avoids any race conditions or out of order message problems. Events can also be sent along a bus if the SLA for consistency is important.</li>
</ul>

<h3 id="versioning">Versioning</h3>

<p>Eventually, we need to deploy. How do we ensure that service A doesn&rsquo;t break anything else on the deploy? We must have strict contracts for any service going out or we must maintain full backwards compatibility. Whatever is easier. Note that depending on the communication fabric, how the versioning is dealt with is different. For REST, there are a <a href="https://www.troyhunt.com/your-api-versioning-is-wrong-which-is/">few ways to version</a>. For an event based system, they also need to be versioned, however, now the publisher may never know if anyone is consuming the events or not, so may not be able to deprecate. Fun times.</p>

<h3 id="qa-costs">QA Costs</h3>

<p>QA becomes a complex problem as there could be no particular set of services that can be &ldquo;validated&rdquo;. How do multiple teams develop against each other? They could deploy their branches to a namespace or perhaps use feature flags which are enabled at runtime for certain tests, etc. Mocking with <a href="http://wiremock.org/">wiremock</a> is also a very good practice here. At a minimum, we need some extra diligence over a monolith:</p>

<ul>
<li>Functional tests with mocks of dependent services - it may not be possible to setup the full environment with all the data required. It is nice to have an authorative mock of a service, but wiremock does make the bar for setting up a mock quite low.</li>
<li>Contract tests - if service A calls service B, A could write contract tests (partially the functional tests) into B&rsquo;s repository.</li>
</ul>

<p>It is very difficult to have effective end to end tests on long paths. Let&rsquo;s say a request goes from A -&gt; B -&gt;&hellip; F-&gt; G. End-to-end tests can test an input at A, and look for an output at G. This detects an error, but doesn&rsquo;t help us with finding out where the error could be.</p>

<p>At least from what I&rsquo;ve seen, due to the complexity, we don&rsquo;t have much choice and have to go with MTTR over MTBF and count on our contracts and versioning if we want to deploy at a reasonable pace.</p>

<h3 id="deployment">Deployment</h3>

<p>Finally, the feature makes it out to production. But, wait, it&rsquo;s not quite ready yet. As with a complex monolith, to detect any failures, we still could use:</p>

<ul>
<li>Canary tests - the ability to put a deploy into production and run it against real data, perhaps for only a set of users/customers.</li>
<li>Journey tests - tracing major workflows through the system. Ensures major functionality doesn&rsquo;t break. This goes step by step and isolates where a problem may have occurred.</li>
<li>Monitoring for exceptions and other faults</li>
</ul>

<p>Now, it&rsquo;s certainly not necessary to have this type of coverage, but it certainly helps.</p>

<h3 id="security">Security</h3>

<p>There are also a variety of security issues that are novel. If we&rsquo;re using containers, then we must also have a way to update containers enmasse. For instance, during the heartbleed vulnerability, the base images would have needed to be updated with the patched libraries and pushed out to production. As compared to virtual machines, where the OS could have been automatically updated.</p>

<p>Another issue could be authorization between service endpoints. If all services can call any endpoint on any other service, what is to prevent any server-side request forgery? If a user can cause a fake request to be sent out, it could cause havoc. So we&rsquo;ll need to implement some sort of authorization mechanism, whether it be JWT tokens with service users or Oauth2 tokens on the client credentials flow. This type of problem doesn&rsquo;t occur with a monolith as any user is already authorized and private interfaces may not be exposed as easily as http endpoints.</p>

<p>And, of course, we need transport encryption on all the services. This could mean we have to maintain a private certificate authority to issue new certificates as novel services get added to the cluster.</p>

<h2 id="costs-with-a-microlith-monoservices-elixir-the-middle-ground">Costs with a microlith/monoservices - Elixir - the middle ground</h2>

<p>In breaking out a monolith to microservices, microlith was a new term that came up from a co-worker, which I promptly decided to steal. Quite frankly, I&rsquo;m not sure if this architecture would be called monoservices or microlith. A microlith sounds more like a distributed monolith, but monoservices don&rsquo;t sound quite as cool.</p>

<p>Anyway, before we took a deep-dive into microservices, we had two goals to drive business value:</p>

<ol>
<li>Build. Ability to iterate features quickly and deploy to production over long periods of time.</li>
<li>Operate. Run in production reliably.</li>
</ol>

<h3 id="so-what-is-elixir">So what is Elixir?</h3>

<p>Firstly, <a href="http://elixir-lang.org/">Elixir</a> is a magical potion that will solve all of the <a href="http://highscalability.com/blog/2014/3/31/how-whatsapp-grew-to-nearly-500-million-users-11000-cores-an.html">problems</a> you may or may not have.</p>

<p>It is also a language built on the Erlang VM, which has been known to build low-latency, highly-concurrent, distributed, and fault-tolerant systems. It is compatible with existing erlang libraries, and its ecosystem has grown a great deal in the past year. The language was designed to build reliable systems, and many consider it a functional language.</p>

<p>And although it would be nice if there was a silver bullet, there isn&rsquo;t one. Elixir gives tooling and a programming paradigm that makes it easier to solve difficult problems about reliability. It also includes an entire framework called the OTP Platform which includes basic boilerplate for reliable systems. The problems, however, still need to be solved.</p>

<h4 id="technical-aside-robustness-principles-microservices-paas-vs-erlang-elixir">Technical aside - robustness principles - Microservices+PAAS vs Erlang/Elixir</h4>

<p>Jose Valim has written an excellent <a href="http://blog.plataformatec.com.br/2015/06/elixir-in-times-of-microservices/">article</a> outlining some of the free items that come with Erlang/Elixir. To summarize, an <em>application</em> in Elixir is the equivalent of a fully independent microservice. I&rsquo;m going to go in a slightly different direction with the comparison.</p>

<p>The primitives that are provided by default in the erlang ecosystem for building reliable systems<sup class="footnote-ref" id="fnref:1"><a href="#fn:1">1</a></sup>:</p>

<ol>
<li>Shared-nothing architecture with processes that have their own state and mailbox and are strongly isolated</li>
<li>Message passing that is designed to be:

<ol>
<li>atomic</li>
<li>arrive ordered between two processes that are communicating <sup class="footnote-ref" id="fnref:2"><a href="#fn:2">2</a></sup></li>
<li>only contain constants.</li>
</ol></li>
<li>Supervision trees that handle restarts and monitoring</li>
<li>Fault detection and reporting</li>
<li>Local vs remote clustering transparency and message routing</li>
<li>Hot code upgrades</li>
<li>Reliable storage<sup class="footnote-ref" id="fnref:3"><a href="#fn:3">3</a></sup></li>
</ol>

<p>For instance, the most basic tenet of scaling is shared nothing architecture. The same principle helps scale from multi-core cpus, since flops per core have been relatively stable, to web-services with massive concurrency. This philosophy is baked into the language itself as the fundamental unit is the extremely lightweight <em>process</em>. As a consequence of shared-nothing, all communication must be via message passing.</p>

<h5 id="table-comparison-of-basic-principles-paas-vs-erlang">Table - comparison of basic principles PAAS vs Erlang</h5>

<table>
<thead>
<tr>
<th align="center">What</th>
<th align="center">Microservices+PAAS</th>
<th align="center">Erlang VM</th>
</tr>
</thead>

<tbody>
<tr>
<td align="center">Shared-nothing</td>
<td align="center">Possible</td>
<td align="center">Default</td>
</tr>

<tr>
<td align="center">Communication fabric</td>
<td align="center">Build it</td>
<td align="center">Default</td>
</tr>

<tr>
<td align="center">Supervision</td>
<td align="center">Yes</td>
<td align="center">Default</td>
</tr>

<tr>
<td align="center">Fault detection</td>
<td align="center">No</td>
<td align="center">Default</td>
</tr>

<tr>
<td align="center">Location transparency/Routing</td>
<td align="center">Usually</td>
<td align="center">Default</td>
</tr>

<tr>
<td align="center">Hot code upgrades</td>
<td align="center">Probably no</td>
<td align="center">Default</td>
</tr>

<tr>
<td align="center">Reliable storage</td>
<td align="center">Sort of</td>
<td align="center">Sort of</td>
</tr>
</tbody>
</table>

<p>Note that though the communication fabric exists, the engineering for reliability still must be done. Even with Elixir, there are plenty of ways to shoot yourself in the foot. Circuit breakers, etc. are still needed. Fault detection is an interesting one. With Elixir, if your database goes down, you can inform all the processes that something happenned.</p>

<h4 id="technical-aside-let-it-crash-an-example-of-these-principles">Technical aside - Let it crash - an example of these principles</h4>

<p>There has been a ton <a href="http://blog.zuehlke.com/wp-content/uploads/2013/09/LetItCrash_Paper.pdf">written</a> on <a href="http://ferd.ca/the-zen-of-erlang.html">let it crash</a>, but I&rsquo;m going to try to summarize.</p>

<p>By having supervision trees and fault detection, we can concentrate on writing happy path code and not worry about transient failures.</p>

<p>I&rsquo;m going to go with a contrived example of a chat service. Let&rsquo;s say the user communicates to a service over a websocket. In a lightweight process, we will spawn a <strong>webserver just for them</strong>. They will also have their own private state. Now if we need to load some data for the user from a cache, we can insert it directly into the state of their webserver to be available for all future interactions. Quite frankly, this entire paragraph may seem absurd for the uninitiated<sup class="footnote-ref" id="fnref:4"><a href="#fn:4">4</a></sup>.</p>

<p>Now imagine that the service needs to talk to a message broker to pass on messages to other users.</p>

<p>So in bad ascii art form, we have:
<pre>
Web browser -&gt; Erlang VM -&gt; User&rsquo;s Webserver -&gt; User&rsquo;s message broker process -&gt; External message broker
</pre></p>

<p>Let&rsquo;s say that the external message broker crashed for some reason. We can handle the error in a few ways, for instance, we can have the message broker process do retries. But we can also crash the user&rsquo;s webserver and propagate the error back to the web browser and have the user retry and reconnect the web socket. Since the user is the owner of the data, we don&rsquo;t need to build in error correction on the entire path.</p>

<p>I can&rsquo;t leave this section without mentioning hot code upgrades. This means that we can upgrade any running code without taking the system down. There&rsquo;s no need for connection draining or blue green deployments.</p>

<h3 id="comparison-with-microservices">Comparison with microservices</h3>

<p>Back to the main point, microservices may reduce the cost of building a new service, but may also increase the cost of QA and operations. We are concerned with trying to optimize both of them.</p>

<p>Now one of the reasons to move from monolithic architectures to microservices is to have clear boundaries and avoid a spaghetti mess over time.<sup class="footnote-ref" id="fnref:5"><a href="#fn:5">5</a></sup> In defining these boundaries, we must establish a contract between different parts of the system and pay an additional network cost. And although each service should be able to deploy and scale independently, to get to a point where we can safely deploy any microservice into production, we made a giant list that needed to be executed from debugging to security.</p>

<p>With Elixir, the closest equivalent of a microservice would be an umbrella application running inside a Erlang VM cluster with an interface of a <a href="http://elixir-lang.org/docs/stable/elixir/GenServer.html">GenServer</a>. A great example of this would be <a href="https://github.com/wojtekmach/acme_bank">Acme Bank Application</a>. This greatly simplifies our testing as we have direct access to all the services at a single commit! We can test the entire system, or we can test an individual application with its dependent services. Yes, that was worth an exclamation mark. We can also deploy the entire system as a package or each application independently, but we have some certainty to the internal interfaces without having to maintain versions and contracts. The key to this is that we can update the system, a collection of services, to a single state at one point in time without having to worry about deployment independence.</p>

<p>Ironically, we don&rsquo;t really need to talk about microservices or applications at all. What we wanted was a clean interface with supervision and restarts. We could build these &ldquo;services&rdquo; inside a single application with multiple GenServers as interfaces. Later we can move the supervision tree to its own application/service. At the end of the day, it comes down to the supervision tree and all communication could occur on a single node without the network costs and scale out later. The point is that we have an interface that separates a unit of development from the unit of deployment.</p>

<h4 id="table-comparison-of-costs-for-a-monolith-for-microservices-and-elixir">Table - comparison of costs for a monolith for microservices and elixir</h4>

<p>To summarize, we get benefits of microservices, without many of the additional costs. Naturally, for very large projects, the overhead increases, but for small to medium projects, there are quite a few wins. You&rsquo;ll see a lot of &ldquo;it depends&rdquo; in the last column because the lines are very fuzzy based on org size, team size, time zones, etc, etc. The interesting part is that for a elixir umbrella apps, you can go either way as the unit of development is different than the unit of deployment.</p>

<table>
<thead>
<tr>
<th align="left">Extra work?</th>
<th align="center">Monolith</th>
<th align="center">Microservices + PAAS</th>
<th align="center">Elixir umbrella apps</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">Automated testing</td>
<td align="center">Yes</td>
<td align="center">Yes</td>
<td align="center">Yes</td>
</tr>

<tr>
<td align="left">Metrics and fault detection</td>
<td align="center">Yes</td>
<td align="center">Yes</td>
<td align="center">Yes</td>
</tr>

<tr>
<td align="left">Canary and Journey tests</td>
<td align="center">Yes</td>
<td align="center">Yes</td>
<td align="center">Yes</td>
</tr>

<tr>
<td align="left">Monolith problems (shared library, scaling)</td>
<td align="center">Yes</td>
<td align="center">No</td>
<td align="center">Maybe</td>
</tr>

<tr>
<td align="left">Anti-patterns for distributed systems</td>
<td align="center">No</td>
<td align="center">Yes</td>
<td align="center">Maybe</td>
</tr>

<tr>
<td align="left">Eventual consistency</td>
<td align="center">No</td>
<td align="center">Maybe</td>
<td align="center">Maybe</td>
</tr>

<tr>
<td align="left">Blue/green deployments</td>
<td align="center">SLA</td>
<td align="center">SLA</td>
<td align="center">No, hot-code updates</td>
</tr>

<tr>
<td align="left">Operations - Hotspots</td>
<td align="center">Yes</td>
<td align="center">No</td>
<td align="center">No</td>
</tr>

<tr>
<td align="left">Operations - PAAS</td>
<td align="center">No</td>
<td align="center">Yes</td>
<td align="center">No</td>
</tr>

<tr>
<td align="left">Operations - Distributed tracing</td>
<td align="center">No</td>
<td align="center">Yes</td>
<td align="center">No, use <a href="http://elixir-lang.org/getting-started/mix-otp/supervisor-and-application.html#observer">observer</a></td>
</tr>

<tr>
<td align="left">Operations - Private CA</td>
<td align="center">No</td>
<td align="center">Maybe</td>
<td align="center">No, certificate pin on cluster</td>
</tr>

<tr>
<td align="left">Communication fabric</td>
<td align="center">No</td>
<td align="center">Yes</td>
<td align="center">No</td>
</tr>

<tr>
<td align="left">Internal API Versioning</td>
<td align="center">No</td>
<td align="center">Yes</td>
<td align="center">No</td>
</tr>

<tr>
<td align="left">QA Functional Tests with Service Mocks</td>
<td align="center">No</td>
<td align="center">Yes</td>
<td align="center">Mostly no, use real app</td>
</tr>

<tr>
<td align="left">QA Contract Tests</td>
<td align="center">No</td>
<td align="center">Yes</td>
<td align="center">Mostly no, entire system tested at once</td>
</tr>

<tr>
<td align="left">Security - containers</td>
<td align="center">No</td>
<td align="center">Yes</td>
<td align="center">No</td>
</tr>

<tr>
<td align="left">Security - oauth/application</td>
<td align="center">No</td>
<td align="center">Yes</td>
<td align="center">No</td>
</tr>
</tbody>
</table>

<h3 id="alternatives">Alternatives</h3>

<p>The advantages of using Erlang/Elixir in a microlith / monoservices architecture are numerous. However, there are alternatives such as <a href="http://paypal.github.io/squbs/">squbs</a> built by Paypal which appears to be something like the OTP framework. There is a great <a href="https://www.paypal-engineering.com/2016/05/11/squbs-a-new-reactive-way-for-paypal-to-build-applications/">blog post</a> explaining the organizational reasons of Akka/JVM over Erlang. I&rsquo;m not sure if it has the same advantages of QA as an Elixir mono-repo with umbrella applications.</p>

<p><a href="http://www.grpc.io/">GRPC</a> is under strong development and could perhaps help a great deal in the communication fabric for arbitrary languages, however, there are still many costs in operating the rest of the system (PAAS, QA, etc.)</p>

<h1 id="conclusion">Conclusion</h1>

<p>There is a middle ground between monoliths and microservices. Whether starting out or trying to decompose a monolith, a microlith might be a good choice. The <a href="http://elixir-lang.org/">Elixir</a> ecosystem provides a great start for providing robust applications in a &ldquo;microlith&rdquo; or &ldquo;monoservice&rdquo; type architecture by allowing clean client/server interfaces with supervision. Large microservices could end up as applications, while smaller ones simple GenServer. However, if your problem domain involves massive computations or some other domain specific problems, perhaps the <a href="http://paypal.github.io/squbs/">Squbs</a> ecosystem based on Akka may be a better fit. Regardless, this isn&rsquo;t a silver bullet, without good development practices, anything can become unmaintainable.</p>

<p>Other than being a single language, <a href="#table-comparison-of-costs-for-a-monolith-for-microservices-and-elixir">this table</a> shows that Elixir with umbrella apps (monorepo) has numerous complexity and cost advantages in operations, qa, and security over monoliths and containerized microservices in a PAAS. See <a href="#table-comparison-of-basic-principles-paas-vs-erlang">this table</a> to understand the differences between a PAAS and the Erlang VM. In fact, given the cost and complexity benefits, if it is possible to pick Erlang/Elixir, I&rsquo;m not sure why anyone would bother with microservices.</p>

<p>A few years ago, even though I would use erlang for my own projects, unless it fit the problem domain exactly, I could never recommend it to anyone because of the weak ecosystem. With the development and community of Elixir, if you&rsquo;re thinking of microservices, maybe you should give Elixir a shot first.<sup class="footnote-ref" id="fnref:6"><a href="#fn:6">6</a></sup></p>
<div class="footnotes">

<hr />

<ol>
<li id="fn:1">Joe Armstrong, one of the creators of Erlang, lists some points on how to create a reliable distributed system in his <a href="http://erlang.org/download/armstrong_thesis_2003.pdf">thesis</a>.
 <a class="footnote-return" href="#fnref:1"><sup>[return]</sup></a></li>
<li id="fn:2">I&rsquo;ve never used this feature myself and I&rsquo;m not sure if would hold true over multiple nodes, but there is a selective receive that is extremely handy.
 <a class="footnote-return" href="#fnref:2"><sup>[return]</sup></a></li>
<li id="fn:3">Doesn&rsquo;t quite compare to the AP systems that we have today.
 <a class="footnote-return" href="#fnref:3"><sup>[return]</sup></a></li>
<li id="fn:4">Comparison with other solutions or languages that support high concurrency. For instance, nodejs uses epoll in a single event loop to process connections, however, any cpu code running may <a href="https://github.com/nodejs/node/blob/master/doc/topics/blocking-vs-non-blocking.md">block the scheduler</a>. A better example may be nginx, a webserver that uses also uses epoll, and sets a number of workers/thread pool to handle blocking work. Now with the cowboy webserver running on the Erlang VM, <em>every connection that comes in has its own webserver code running</em>. That is not a typo. This has huge implications on how web applications can be built from the ground up.
 <a class="footnote-return" href="#fnref:4"><sup>[return]</sup></a></li>
<li id="fn:5">There&rsquo;s really no reason why boundaries can&rsquo;t be well-defined in a monolith. I&rsquo;m rolling with it.
 <a class="footnote-return" href="#fnref:5"><sup>[return]</sup></a></li>
<li id="fn:6">For the longest time, Erlang has been a sanctuary for me, so for personal reasons I have trouble sharing it. It&rsquo;s like that a special spot on an island, just cresting above the rocks of high tide, shade of a willow tree sheltering against the southern sun, while the waves crash on the shore on the bluest of days.
 <a class="footnote-return" href="#fnref:6"><sup>[return]</sup></a></li>
</ol>
</div>

    <div id="social-bar">
	<ul class="rrssb-buttons clearfix">
      <li class="email">
          <a href="mailto:?subject=Dawn%20of%20the%20Microlith%20-%20Monoservices%20with%20Elixir&amp;body=http://tjheeta.github.io/2016/12/16/dawn-of-the-microlith-monoservices-microservices-with-elixir/">
              <span class="icon">
                  <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                      <path transform="scale(0.014,-0.014) translate(0,-1670)" d="M1792 826v-794q0 -66 -47 -113t-113 -47h-1472q-66 0 -113 47t-47 113v794q44 -49 101 -87q362 -246 497 -345q57 -42 92.5 -65.5t94.5 -48t110 -24.5h1h1q51 0 110 24.5t94.5 48t92.5 65.5q170 123 498 345q57 39 100 87zM1792 1120q0 -79 -49 -151t-122 -123 q-376 -261 -468 -325q-10 -7 -42.5 -30.5t-54 -38t-52 -32.5t-57.5 -27t-50 -9h-1h-1q-23 0 -50 9t-57.5 27t-52 32.5t-54 38t-42.5 30.5q-91 64 -262 182.5t-205 142.5q-62 42 -117 115.5t-55 136.5q0 78 41.5 130t118.5 52h1472q65 0 112.5 -47t47.5 -113z"/>
                  </svg>
              </span>
              <span class="text">Email</span>
          </a>
      </li>
      <li class="facebook">
          <a href="https://www.facebook.com/sharer/sharer.php?u=http://tjheeta.github.io/2016/12/16/dawn-of-the-microlith-monoservices-microservices-with-elixir/" class="popup">
              <span class="icon">
                  <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                      <path d="M27.825,4.783c0-2.427-2.182-4.608-4.608-4.608H4.783c-2.422,0-4.608,2.182-4.608,4.608v18.434 c0,2.427,2.181,4.608,4.608,4.608H14V17.379h-3.379v-4.608H14v-1.795c0-3.089,2.335-5.885,5.192-5.885h3.718v4.608h-3.726 c-0.408,0-0.884,0.492-0.884,1.236v1.836h4.609v4.608h-4.609v10.446h4.916c2.422,0,4.608-2.188,4.608-4.608V4.783z"/>
                  </svg>
              </span>
              <span class="text">Facebook</span>
          </a>
      </li>
			<li class="twitter">
          <a href="http://twitter.com/home?status=Dawn%20of%20the%20Microlith%20-%20Monoservices%20with%20Elixir%20http://tjheeta.github.io/2016/12/16/dawn-of-the-microlith-monoservices-microservices-with-elixir/" class="popup">
              <span class="icon">
                  <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
		                  <path d="M24.253,8.756C24.689,17.08,18.297,24.182,9.97,24.62c-3.122,0.162-6.219-0.646-8.861-2.32 c2.703,0.179,5.376-0.648,7.508-2.321c-2.072-0.247-3.818-1.661-4.489-3.638c0.801,0.128,1.62,0.076,2.399-0.155 C4.045,15.72,2.215,13.6,2.115,11.077c0.688,0.275,1.426,0.407,2.168,0.386c-2.135-1.65-2.729-4.621-1.394-6.965 C5.575,7.816,9.54,9.84,13.803,10.071c-0.842-2.739,0.694-5.64,3.434-6.482c2.018-0.623,4.212,0.044,5.546,1.683 c1.186-0.213,2.318-0.662,3.329-1.317c-0.385,1.256-1.247,2.312-2.399,2.942c1.048-0.106,2.069-0.394,3.019-0.851 C26.275,7.229,25.39,8.196,24.253,8.756z"/>
                  </svg>
              </span>
              <span class="text">Twitter</span>
          </a>
      </li>
			<li class="linkedin">
          <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=http://tjheeta.github.io/2016/12/16/dawn-of-the-microlith-monoservices-microservices-with-elixir/&amp;title=Dawn%20of%20the%20Microlith%20-%20Monoservices%20with%20Elixir&amp;summary=Introduction%20Microservices%20are%20the%20newest%20technology%20trend%20and%20should%20be%20approached%20with%20deliberation.%20There%20is%20a%20ludicrous%20amount%20of%20subject%20matter%20on%20it%2c%20which%20I%26rsquo%3bm%20not%20going%20to%20cover.%20The%20important%20part%20to%20understand%20is%20if%20they%20are%20a%20fit%20for%20your%20organization.%0aTo%20measure%20if%20the%20architecture%20adds%20business%20value%2c%20it%20really%20comes%20down%20to%20how%20quickly%20can%20features%20be%20released%20to%20production%20and%20the%20stability%20%2f%20maintainability%20of%20the%20codebase...." class="popup">
              <span class="icon">
                  <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                      <path d="M25.424,15.887v8.447h-4.896v-7.882c0-1.979-0.709-3.331-2.48-3.331c-1.354,0-2.158,0.911-2.514,1.803 c-0.129,0.315-0.162,0.753-0.162,1.194v8.216h-4.899c0,0,0.066-13.349,0-14.731h4.899v2.088c-0.01,0.016-0.023,0.032-0.033,0.048 h0.033V11.69c0.65-1.002,1.812-2.435,4.414-2.435C23.008,9.254,25.424,11.361,25.424,15.887z M5.348,2.501 c-1.676,0-2.772,1.092-2.772,2.539c0,1.421,1.066,2.538,2.717,2.546h0.032c1.709,0,2.771-1.132,2.771-2.546 C8.054,3.593,7.019,2.501,5.343,2.501H5.348z M2.867,24.334h4.897V9.603H2.867V24.334z"/>
                  </svg>
              </span>
              <span class="text">LinkedIn</span>
          </a>
      </li>
      <li class="tumblr">
					<script>
						document.write('<a href="http://www.tumblr.com/share?v=3&amp;u=' + encodeURIComponent('http:\/\/tjheeta.github.io\/2016\/12\/16\/dawn-of-the-microlith-monoservices-microservices-with-elixir\/') + '&amp;t=Dawn of the Microlith - Monoservices with Elixir" class="popup">');
					</script>
              <span class="icon">
                  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
											<path d="M18.02 21.842c-2.029 0.052-2.422-1.396-2.439-2.446v-7.294h4.729V7.874h-4.71V1.592c0 0-3.653 0-3.714 0 s-0.167 0.053-0.182 0.186c-0.218 1.935-1.144 5.33-4.988 6.688v3.637h2.927v7.677c0 2.8 1.7 6.7 7.3 6.6 c1.863-0.03 3.934-0.795 4.392-1.453l-1.22-3.539C19.595 21.6 18.7 21.8 18 21.842z"/>
									</svg>
              </span>
              <span class="text">Tumblr</span>
          <script>document.write('</a>');</script>
      </li>
      <li class="reddit">
          <a href="http://www.reddit.com/submit?url=http://tjheeta.github.io/2016/12/16/dawn-of-the-microlith-monoservices-microservices-with-elixir/">
              <span class="icon">
                  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
											<g>
													<path d="M11.794 15.316c0-1.029-0.835-1.895-1.866-1.895c-1.03 0-1.893 0.865-1.893 1.895s0.863 1.9 1.9 1.9 C10.958 17.2 11.8 16.3 11.8 15.316z"/>
													<path d="M18.1 13.422c-1.029 0-1.895 0.864-1.895 1.895c0 1 0.9 1.9 1.9 1.865c1.031 0 1.869-0.836 1.869-1.865 C19.969 14.3 19.1 13.4 18.1 13.422z"/>
													<path d="M17.527 19.791c-0.678 0.678-1.826 1.006-3.514 1.006c-0.004 0-0.009 0-0.014 0c-0.004 0-0.01 0-0.015 0 c-1.686 0-2.834-0.328-3.51-1.005c-0.264-0.265-0.693-0.265-0.958 0c-0.264 0.265-0.264 0.7 0 1 c0.943 0.9 2.4 1.4 4.5 1.402c0.005 0 0 0 0 0c0.005 0 0 0 0 0c2.066 0 3.527-0.459 4.47-1.402 c0.265-0.264 0.265-0.693 0.002-0.958C18.221 19.5 17.8 19.5 17.5 19.791z"/>
													<path d="M27.707 13.267c0-1.785-1.453-3.237-3.236-3.237c-0.793 0-1.518 0.287-2.082 0.761c-2.039-1.295-4.646-2.069-7.438-2.219 l1.483-4.691l4.062 0.956c0.071 1.4 1.3 2.6 2.7 2.555c1.488 0 2.695-1.208 2.695-2.695C25.881 3.2 24.7 2 23.2 2 c-1.059 0-1.979 0.616-2.42 1.508l-4.633-1.091c-0.344-0.081-0.693 0.118-0.803 0.455l-1.793 5.7 C10.548 8.6 7.7 9.4 5.6 10.75C5.006 10.3 4.3 10 3.5 10.029c-1.785 0-3.237 1.452-3.237 3.2 c0 1.1 0.6 2.1 1.4 2.69c-0.04 0.272-0.061 0.551-0.061 0.831c0 2.3 1.3 4.4 3.7 5.9 c2.299 1.5 5.3 2.3 8.6 2.325c3.228 0 6.271-0.825 8.571-2.325c2.387-1.56 3.7-3.66 3.7-5.917 c0-0.26-0.016-0.514-0.051-0.768C27.088 15.5 27.7 14.4 27.7 13.267z M23.186 3.355c0.74 0 1.3 0.6 1.3 1.3 c0 0.738-0.6 1.34-1.34 1.34s-1.342-0.602-1.342-1.34C21.844 4 22.4 3.4 23.2 3.355z M1.648 13.3 c0-1.038 0.844-1.882 1.882-1.882c0.31 0 0.6 0.1 0.9 0.209c-1.049 0.868-1.813 1.861-2.26 2.9 C1.832 14.2 1.6 13.8 1.6 13.267z M21.773 21.57c-2.082 1.357-4.863 2.105-7.831 2.105c-2.967 0-5.747-0.748-7.828-2.105 c-1.991-1.301-3.088-3-3.088-4.782c0-1.784 1.097-3.484 3.088-4.784c2.081-1.358 4.861-2.106 7.828-2.106 c2.967 0 5.7 0.7 7.8 2.106c1.99 1.3 3.1 3 3.1 4.784C24.859 18.6 23.8 20.3 21.8 21.57z M25.787 14.6 c-0.432-1.084-1.191-2.095-2.244-2.977c0.273-0.156 0.59-0.245 0.928-0.245c1.035 0 1.9 0.8 1.9 1.9 C26.354 13.8 26.1 14.3 25.8 14.605z"/>
											</g>
									</svg>
              </span>
              <span class="text">Reddit</span>
          </a>
      </li>
      <li class="googleplus">
          <a href="https://plus.google.com/share?url=http://tjheeta.github.io/2016/12/16/dawn-of-the-microlith-monoservices-microservices-with-elixir/" class="popup">
              <span class="icon">
                  <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                      <g>
                          <path d="M14.703,15.854l-1.219-0.948c-0.372-0.308-0.88-0.715-0.88-1.459c0-0.748,0.508-1.223,0.95-1.663 c1.42-1.119,2.839-2.309,2.839-4.817c0-2.58-1.621-3.937-2.399-4.581h2.097l2.202-1.383h-6.67c-1.83,0-4.467,0.433-6.398,2.027 C3.768,4.287,3.059,6.018,3.059,7.576c0,2.634,2.022,5.328,5.604,5.328c0.339,0,0.71-0.033,1.083-0.068 c-0.167,0.408-0.336,0.748-0.336,1.324c0,1.04,0.551,1.685,1.011,2.297c-1.524,0.104-4.37,0.273-6.467,1.562 c-1.998,1.188-2.605,2.916-2.605,4.137c0,2.512,2.358,4.84,7.289,4.84c5.822,0,8.904-3.223,8.904-6.41 c0.008-2.327-1.359-3.489-2.829-4.731H14.703z M10.269,11.951c-2.912,0-4.231-3.765-4.231-6.037c0-0.884,0.168-1.797,0.744-2.511 c0.543-0.679,1.489-1.12,2.372-1.12c2.807,0,4.256,3.798,4.256,6.242c0,0.612-0.067,1.694-0.845,2.478 c-0.537,0.55-1.438,0.948-2.295,0.951V11.951z M10.302,25.609c-3.621,0-5.957-1.732-5.957-4.142c0-2.408,2.165-3.223,2.911-3.492 c1.421-0.479,3.25-0.545,3.555-0.545c0.338,0,0.52,0,0.766,0.034c2.574,1.838,3.706,2.757,3.706,4.479 c-0.002,2.073-1.736,3.665-4.982,3.649L10.302,25.609z"/>
                          <polygon points="23.254,11.89 23.254,8.521 21.569,8.521 21.569,11.89 18.202,11.89 18.202,13.604 21.569,13.604 21.569,17.004 23.254,17.004 23.254,13.604 26.653,13.604 26.653,11.89"/>
                      </g>
                  </svg>
              </span>
              <span class="text">Google+</span>
          </a>
      </li>
      <li class="pinterest">
          <script>
						var imgurl = "http:\/\/tjheeta.github.io\/logo.png";
						var firstimg = document.getElementsByClassName("post")[0].getElementsByTagName("img")[0];
						if (firstimg !== undefined) {
							imgurl = firstimg.src;
						}
						document.write('<a href="http://pinterest.com/pin/create/button/?url=http:\/\/tjheeta.github.io\/2016\/12\/16\/dawn-of-the-microlith-monoservices-microservices-with-elixir\/&amp;media=' + imgurl + '&amp;description=Dawn of the Microlith - Monoservices with Elixir" class="popup">');
					</script>
              <span class="icon">
                  <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
		                  <path d="M14.021,1.57C6.96,1.57,1.236,7.293,1.236,14.355c0,7.062,5.724,12.785,12.785,12.785c7.061,0,12.785-5.725,12.785-12.785 C26.807,7.294,21.082,1.57,14.021,1.57z M15.261,18.655c-1.161-0.09-1.649-0.666-2.559-1.219c-0.501,2.626-1.113,5.145-2.925,6.458 c-0.559-3.971,0.822-6.951,1.462-10.116c-1.093-1.84,0.132-5.545,2.438-4.632c2.837,1.123-2.458,6.842,1.099,7.557 c3.711,0.744,5.227-6.439,2.925-8.775c-3.325-3.374-9.678-0.077-8.897,4.754c0.19,1.178,1.408,1.538,0.489,3.168 C7.165,15.378,6.53,13.7,6.611,11.462c0.131-3.662,3.291-6.227,6.46-6.582c4.007-0.448,7.771,1.474,8.29,5.239 c0.579,4.255-1.816,8.865-6.102,8.533L15.261,18.655z"/>
                  </svg>
              </span>
              <span class="text">Pinterest</span>
          <script>document.write('</a>');</script>
      </li>
      <li class="pocket">
          <a href="https://getpocket.com/save?url=http://tjheeta.github.io/2016/12/16/dawn-of-the-microlith-monoservices-microservices-with-elixir/"  class="popup">
              <span class="icon">
                  <svg width="32px" height="28px" viewBox="0 0 32 28" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                      <path d="M28.7817528,0.00172488695 C30.8117487,0.00431221738 31.9749312,1.12074529 31.9644402,3.10781507 C31.942147,6.67703739 32.1336065,10.2669583 31.8057648,13.8090137 C30.7147076,25.5813672 17.2181194,31.8996281 7.20714461,25.3808491 C2.71833574,22.4571656 0.196577202,18.3122624 0.0549495772,12.9357897 C-0.0342233715,9.5774348 0.00642900214,6.21519891 0.0300336062,2.85555035 C0.0405245414,1.1129833 1.21157517,0.0146615391 3.01995012,0.00819321302 C7.34746087,-0.00603710433 11.6775944,0.00431221738 16.0064164,0.00172488695 C20.2644248,0.00172488695 24.5237444,-0.00215610869 28.7817528,0.00172488695 L28.7817528,0.00172488695 Z M8.64885184,7.85611511 C7.38773662,7.99113854 6.66148108,8.42606978 6.29310958,9.33228474 C5.90114134,10.2969233 6.17774769,11.1421181 6.89875951,11.8276216 C9.35282156,14.161969 11.8108164,16.4924215 14.2976518,18.7943114 C15.3844131,19.7966007 16.5354102,19.7836177 17.6116843,18.7813283 C20.0185529,16.5495467 22.4070683,14.2982907 24.7824746,12.0327533 C25.9845979,10.8850542 26.1012707,9.56468083 25.1469132,8.60653379 C24.1361858,7.59255976 22.8449191,7.6743528 21.5890476,8.85191291 C19.9936451,10.3488554 18.3680912,11.8172352 16.8395462,13.3777945 C16.1342655,14.093159 15.7200114,14.0048744 15.0566806,13.3440386 C13.4599671,11.7484252 11.8081945,10.2060421 10.1262706,8.70001155 C9.65564653,8.27936164 9.00411403,8.05345704 8.64885184,7.85611511 L8.64885184,7.85611511 L8.64885184,7.85611511 Z"></path>
                  </svg>
              </span>
              <span class="text">Pocket</span>
          </a>
      </li>
  </ul>
</div>

    <div itemprop="author" itemscope itemtype="http://schema.org/Person">
</div>

    <div id="comments">
    
    
    
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      var disqus_shortname = 'tjheetagithubio';
      var disqus_identifier = 'http:\/\/tjheeta.github.io\/2016\/12\/16\/dawn-of-the-microlith-monoservices-microservices-with-elixir\/';
      var disqus_title = 'Dawn of the Microlith - Monoservices with Elixir';
      var disqus_url = 'http:\/\/tjheeta.github.io\/2016\/12\/16\/dawn-of-the-microlith-monoservices-microservices-with-elixir\/';
      (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    
    
</div>

</article>

</main>
		<footer id="footer">
            <section id="footer-message">&copy; All rights reserved. Powered by <a href="http://gohugo.io" target="_blank">Hugo</a>. <a href="https://github.com/kathyqian/crisp-ghost-theme" target="_blank">Crisp</a></section>
		</footer>

    <script>
      (function(c,f){asyncLoader=function(i,h){i.foreach(function(k,j){e(j,d(j),h)});if(typeof h.callback=="function"){var g=setInterval(function(){if(f.readyState==="complete"){clearInterval(g);h.callback()}},10)}};var d=function(g){var h=g.split(".");return h[h.length-1]},e=function(h,i,g){switch(i){case"js":a(h,g);break;case"css":b(h);break;default:break}},a=function(i,h){var g=document.createElement("script");g.type="text/javascript";g.async=true;g.src=i;document.getElementsByTagName("head")[0].appendChild(g)},b=function(g){var h=document.createElement("link");h.type="text/css";h.rel="stylesheet";h.href=g;document.getElementsByTagName("head")[0].appendChild(h)};Array.prototype.foreach=function(h){for(var g=0;g<this.length;g++){h(g,this[g])}}})(this,document);

      var WebFontConfig={google:{families:["Open Sans:300italic,700italic,300,700","Bree+Serif"]}};
      asyncLoader([
        "//netdna.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.css",
        "//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js",
        "//cdnjs.cloudflare.com/ajax/libs/webfont/1.5.16/webfontloader.js",
        "//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js"
      ],{
        callback:function(){
          asyncLoader([
            "http:\/\/tjheeta.github.io\/css/rrssb.css",
            "http:\/\/tjheeta.github.io\/js/gist.min.js", 
            "http:\/\/tjheeta.github.io\/js/rrssb.min.js",
            "//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/default.min.css"
          ], { callback:function() {
              hljs.initHighlighting();
          }});
        }
      });
    </script>
	
    <script>
    if (document.location.hostname.search("tjheeta.github.io") !== -1) {
    	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      	ga('create', 'UA-37953155-2', 'auto');
      	ga('send', 'pageview');
    }
    </script>
  
	</body>
</html>

